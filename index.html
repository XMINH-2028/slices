<!DOCTYPE html> 
<html lang="en">
<head> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slices</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="../../bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
</head>
<body>
        <div class="container-fluid" id="main">
            <h1 class="h1 text-center" id="selectsize">SELECT SIZE</h1>
            <div class="row" id="top">
                <button class="btn btn-primary btn-md col-3 mx-auto rounded-0" id="size" onclick="choosesize(this,3)">Size 3*3</button>
                <button class="btn btn-success btn-md col-3 mx-auto rounded-0" id="size" onclick="choosesize(this,4)">Size 4*4</button>
                <button class="btn btn-warning btn-md col-3 mx-auto rounded-0" id="size" onclick="choosesize(this,5)">Size 5*5</button>
                <button class="btn btn-danger btn-md col-3 mx-auto rounded-0" id="size" onclick="choosesize(this,6)">Size 6*6</button>
            </div>
            <h1 class="h1 text-center text-primary mt-5" id="selectimage">SELECT IMAGE</h1>
            <div id="picture" class="flex-wrap justify-content-center mt-5 align-content-end">          
                <div class="p-2"> 
                    <img src="images/banh.png" alt="" onclick="picture(this,'images/banh.png')" id="img1">
                </div>
                <div class="p-2">
                    <img src="images/butterfly.jpg" alt="" onclick="picture(this,'images/butterfly.jpg')" id="img2">
                </div>
                <div class="p-2">
                    <img src="images/cat.jpg" alt="" onclick="picture(this,'images/cat.jpg')" id="img3">
                </div>
                <div class="p-2">
                    <img src="images/dolphin.jpg" alt="" onclick="picture(this,'images/dolphin.jpg')" id="img4">
                </div>
                <div class="p-2">
                    <img src="images/dragonfly.jpg" alt="" onclick="picture(this,'images/dragonfly.jpg')" id="img5">
                </div>
                <div class="p-2">
                    <img src="images/elephant.jpg" alt="" onclick="picture(this,'images/elephant.jpg')" id="img6">
                </div>
                <div class="p-2">
                    <img src="images/koala.jpg" alt="" onclick="picture(this,'images/koala.jpg')" id="img7">
                </div>
                <div class="p-2">
                    <img src="images/Lighthouse.jpg" alt="" onclick="picture(this,'images/Lighthouse.jpg')" id="img8">
                </div>
                <div class="p-2">
                    <img src="images/lotus.jpg" alt="" onclick="picture(this,'images/lotus.jpg')" id="img9">
                </div>
                <div class="p-2">
                    <img src="images/monkey.jpg" alt="" onclick="picture(this,'images/monkey.jpg')" id="img10">
                </div>
                <div class="p-2">
                    <img src="images/rose.jpg" alt="" onclick="picture(this,'images/rose.jpg')" id="img11">
                </div>
                <div class="p-2">
                    <img src="images/sunflower.jpg" alt="" onclick="picture(this,'images/sunflower.jpg')" id="img12">
                </div>
                <div class="p-2">
                    <img src="images/winter.jpg" alt="" onclick="picture(this,'images/winter.jpg')" id="img13">
                </div>
            </div>
            <h1 class="h1 text-center text-primary" id="xchoice">X-CHOICE</h1>
            <div class="row my-3 mx-0" id="nexttop">
                <p class="text-center col-sm-6 justify-content-center align-items-center" id="topleft">
                    <button class="btn-lg btn-success mr-2"><a href="#" class="text-light" onmousedown="start()">START</a></button>
                    <button class="btn-lg btn-warning ml-2"><a href="index.html" class="text-dark">RESET</a></button>
                </p>
                <p class="text-center col-sm-6 justify-content-center align-items-center" id="topright">
                    <svg width="3em" height="3em" viewBox="0 0 16 16" class="bi bi-alarm text-primary" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M8 15A6 6 0 1 0 8 3a6 6 0 0 0 0 12zm0 1A7 7 0 1 0 8 2a7 7 0 0 0 0 14z"/>
                        <path fill-rule="evenodd" d="M8 4.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.053.224l-1.5 3a.5.5 0 1 1-.894-.448L7.5 8.882V5a.5.5 0 0 1 .5-.5z"/>
                        <path d="M.86 5.387A2.5 2.5 0 1 1 4.387 1.86 8.035 8.035 0 0 0 .86 5.387zM11.613 1.86a2.5 2.5 0 1 1 3.527 3.527 8.035 8.035 0 0 0-3.527-3.527z"/>
                        <path fill-rule="evenodd" d="M11.646 14.146a.5.5 0 0 1 .708 0l1 1a.5.5 0 0 1-.708.708l-1-1a.5.5 0 0 1 0-.708zm-7.292 0a.5.5 0 0 0-.708 0l-1 1a.5.5 0 0 0 .708.708l1-1a.5.5 0 0 0 0-.708zM5.5.5A.5.5 0 0 1 6 0h4a.5.5 0 0 1 0 1H6a.5.5 0 0 1-.5-.5z"/>
                        <path d="M7 1h2v2H7V1z"/>
                      </svg>
                    <span id="hour" class="text-danger"></span>:<span id="minute" class="text-warning"></span>:<span id="second" class="text-success"></span>
                </p>
            </div>
            <div class="row position-relative" id="content">     
                <div class="col-xl-6 mb-xl-0 mb-2">
                    <table cellspacing="0px" class="mx-auto" id="table0">
                    </table>
                </div>
                <div class="col-xl-6">
                    <table cellspacing="0px" class="mx-auto" id="table1">
                    </table>
                </div>
                <div class="position-absolute" id="cover">
               
                </div>
            </div>     
        </div>
        <div class="row mt-5 ">
            <p id="test" class="col-1"></p>
            <p id="test1" class="col-1"></p>
            <p id="test2" class="col-2 text-right"></p>
            <p id="test3" class="col-1"></p>
            <p id="test4" class="col-2 text-right"></p>
            <p id="test5" class="col-1"></p>
            <p id="test6" class="col-2 text-right"></p>
            <p id="test7" class="col-1 "></p>
            <p id="test8" class="col-1 "></p>
        </div> 
         
    <script>
        var i,j,k,n,t,r,b,l,x,y;
        var tdnumber=[0];
        var imgnumber=[0];
        var topimg=[0];
        var leftimg=[0];
        var topclip=[0];
        var leftclip=[0];
        var topimgclip=[0];
        var leftimgclip=[0];
        var cliptop=[0];
        var clipright=[0];
        var clipbottom=[0];
        var clipleft=[0];
        var n=0;
        var k=0;
        var countrandom=[0];
        var countresult=[0];
        var nbtd = 0;
        var nbtd1 = 0;
        var nbtd2 = 0;
        var nbimg = 0;
        var findmin=[0];
        var nbmin=[0];
        var nbhd=[0];
        var sizemain;
        var text="";
        var nube=0;
        var hr,me,sd;
        var seth,setw;
        var choicesize=0;
        var choiceimage=0;
        var adds="";
        var countclickno = [0];
        var countclicktd = [0];
        //Hàm cắt ảnh
        function Cut() {
            document.getElementById("selectsize").style.display="none";
            document.getElementById("selectimage").style.display="none";
            document.getElementById("top").style.display="none";
            document.getElementById("picture").style.display="none";
            document.getElementById("topleft").style.display="flex";
            document.getElementById("cover").style.display="block";
            document.getElementById("xchoice").style.display="block";
            for (i=1;i<=sizemain;i++){
                text += "<tr>";
                for (j=1;j<=sizemain;j++){
                    nube += 1;
                    text += "<td id='tdno"+ nube +"' onclick='set(this,"+'"no"'+"," + nube + ")' ondblclick='hidn(this,"+'"no"'+"," + nube + ")'><img src='' alt='' id="+'"no'+ nube + '"></td>';
                }
                text += "</tr>";
            }
            document.getElementById("table0").innerHTML=text;
            nube=0;
            text="";
            for (i=1;i<=sizemain;i++){
                text += "<tr>";
                for (j=1;j<=sizemain;j++){
                    nube += 1;
                    text += "<td id='tdtd"+ nube +"' onclick='set(this,"+'"td"'+"," + nube + ")' ondblclick='hidn(this,"+'"td"'+"," + nube + ")'><img src='' alt='' id="+'"td'+ nube + '"></td>';
                }
                text += "</tr>";
            }
            document.getElementById("table1").innerHTML=text;
            /*Thiết lập đơn vị theo kích thước màn hình*/
            setw=Math.round(screen.width*0.35);
            seth=Math.round(screen.height*0.35);
            if (setw%sizemain==0) {
                setw = setw;
            } else {
                for (i=1;i<=(sizemain-1);i++){
                    setw=setw-1;
                    if (setw%sizemain==0){
                        i=sizemain;
                    }
                }
            }
            if (seth%sizemain==0) {
                seth = seth;
            } else {
                for (i=1;i<=(sizemain-1);i++){
                    seth=seth-1;
                    if (seth%sizemain==0){
                        i=sizemain;
                    }
                }
            }
            if (setw >= seth) {
                seth = setw;
            } else {
                setw=seth;
            }
            for (i=1;i<=sizemain*sizemain;i++){
                document.getElementById("no"+i).style.position="absolute";
                document.getElementById("no"+i).style.animationName="example";
                document.getElementById("td"+i).style.position="absolute";
                document.getElementById("tdtd"+i).style.animationName="example0";
                document.getElementById("tdno"+i).style.width=setw/sizemain+"px";
                document.getElementById("tdno"+i).style.width=seth/sizemain+"px";
                document.getElementById("tdtd"+i).style.width=setw/sizemain+"px";
                document.getElementById("tdtd"+i).style.width=seth/sizemain+"px";
            }
            document.getElementById("table0").style.width=setw +"px";
            document.getElementById("table0").style.height=seth +"px";
            document.getElementById("table1").style.width=setw +"px";
            document.getElementById("table1").style.height=seth +"px";
            for (i=1;i<=sizemain*sizemain;i++){
                document.getElementById("no"+i).style.height=seth+"px";
                document.getElementById("no"+i).style.width=setw+"px";
            }
            /*Vị trí top của khung chứa ảnh căt-dùng cho random*/
            for (i = 1; i <= sizemain*sizemain; i++){
                topimg[i]=n*seth/sizemain;
                k++;
                if (k%sizemain == 0){
                    n++;
                }
            }
            /*Vị trí left của khung chứa ảnh căt-dùng cho random*/
            n=0;
            for (i = 1; i <= sizemain*sizemain; i++){
                leftimg[i]=n*setw/sizemain;
                n++;
                if (n%sizemain == 0){
                    n = 0;
                }
            }
            /*Vị trí top của khung ảnh cắt-dùng cho random*/
            n=0;
            k=0;
            for (i = 1; i <= sizemain*sizemain; i++){
                topclip[i]=n*seth/sizemain;
                k++;
                if (k%sizemain == 0){
                    n++;
                }
            }
            /*Vị trí left của khung ảnh cắt-dùng cho random*/
            n=0;
            for (i = 1; i <= sizemain*sizemain; i++){
                leftclip[i]=n*setw/sizemain;
                n++;
                if (n%sizemain == 0){
                    n = 0;
                }
            }
            /*Random vị trí khung chứa ảnh cắt*/ 
            for (i = 1; i <= sizemain*sizemain;)
            {
                tdnumber[i]=Math.ceil(Math.random()*sizemain*sizemain);
                k=0;
                for (j = 1; j < i; j++){
                        if (tdnumber[i] == tdnumber[j]){
                            k = k + 1;
                        }
                }
                if (k == 0){
                    i = i + 1;
                }
            }
            /*Random vị trí ảnh nằm trong khung chứa*/ 
            for (i = 1; i <= sizemain*sizemain;)
            {
                imgnumber[i]=Math.ceil(Math.random()*sizemain*sizemain);
                k=0;
                for (j = 1; j < i; j++){
                        if (imgnumber[i] == imgnumber[j]){
                            k = k + 1;
                        }
                }
                if (k == 0){
                    i = i + 1;
                }
            }
            /*Vị trí của khung ảnh khi thực hiện cắt*/ 
            for (i = 1; i <= sizemain*sizemain; i++){
                topimgclip[i] = topimg[tdnumber[i]] - topclip[imgnumber[i]];
                leftimgclip[i] = leftimg[tdnumber[i]] - leftclip[imgnumber[i]];
            }
            /*Lấy các thông số khi thực hiện cắt cho các ô ảnh từ 1 đến 25*/ 
            n=0;
            t=0;
            r=setw/sizemain;
            b=seth/sizemain;
            l=0;
            for (i = 1; i <= sizemain*sizemain; i++){
                cliptop[i]=t;
                clipright[i]=r;
                clipbottom[i]=b;
                clipleft[i]=l;
                r=r + setw/sizemain;
                l=l + setw/sizemain;
                if (r == setw*(sizemain+1)/sizemain){
                    t = t + seth/sizemain;
                    b = b + seth/sizemain;
                    r = setw/sizemain;
                    l = 0;
                }
            }
            /*Thực hiện cắt ảnh*/ 
            t=0;
            r=0;
            b=0;
            l=0;
            k=1;
            for (i = 1; i <= sizemain*sizemain;){
                for (j = 1; j <= sizemain*sizemain; j++){
                    if(tdnumber[j] == i){
                        x=document.getElementById("no" + tdnumber[j]);
                        x.src=adds;
                        x.style.animationDuration= k+"s";
                        k=k+0.2;
                        x.style.top = topimgclip[j] + "px";
                        x.style.left= leftimgclip[j] + "px";
                        t = cliptop[imgnumber[j]];
                        r = clipright[imgnumber[j]];
                        b = clipbottom[imgnumber[j]];
                        l = clipleft[imgnumber[j]];
                        x.style.clip= "rect("+ t + "px,"+ r + "px,"+ b + "px,"+ l + "px)";
                        i++;
                    }
                }
            }
            /*Set animationDuration cho khung kết quả + tạo 2 mảng thể hiện sự nhập xuất cảu ảnh ở 
            phần ảnh random và ảnh kết quả + khai báo biến chứa ảnh đã bị ẩn ở phần kết quả khi thực
            hiện trả về hoặc đổi ảnh*/ 
            k=1;
            for (i = 1; i <= sizemain*sizemain; i++){
                x=document.getElementById("tdtd"+i);
                x.style.animationDuration=k+"s";
                k=k+0.1;
                countrandom[i] = i;
                countresult[i] = 0;
                nbhd[i]=0;
            }
            //Đặt kích thước, màu nền cho cover
            document.getElementById("cover").style.height=seth+"px";  
            document.getElementById("cover").style.width="100vw";
            document.getElementById("cover").style.backgroundColor="transparant";
        }
        //Hàm chọn kích thước
        function choosesize(elm0,clr0){
            sizemain=clr0;
            if (choicesize == 0) {
            choicesize += 1;
            }
            if ((choiceimage+choicesize) == 2) {
                Cut();
            }
        }
        //Hàm chọn ảnh
        function picture(elmn,clr) {
            adds = clr;
            for (i=1; i<=13; i++){
                document.getElementById("img"+i).style.borderRadius="0px";
            }
            elmn.style.borderRadius="50px";
            if (choiceimage == 0) {
                choiceimage += 1;
            }
            if ((choiceimage+choicesize) == 2) {
                Cut();
            }
        }
        //Hàm bắt đầu chơi
        var timer;
        timer=0;
        function start(){
            if (timer == 0){
                //Set Time count
                document.getElementById("topright").style.display="flex";
                document.getElementById("hour").innerHTML="00";
                document.getElementById("minute").innerHTML="00";
                document.getElementById("second").innerHTML="00";
                setInterval(visible,1000);
                sd=1;
                me=0;
                hr=0;  
                function visible(){
                    if (sd<=60){
                        if (sd<10){
                            document.getElementById("second").innerHTML="0"+sd;
                        } else {
                            if (sd==60){
                                document.getElementById("second").innerHTML="00";
                            }else{
                                document.getElementById("second").innerHTML=sd;
                            }
                        }
                        sd +=1;
                        if (sd==61){
                            me += 1;
                            if (me<10){
                                document.getElementById("minute").innerHTML="0"+me;
                            }else {
                            if (me==60){
                                document.getElementById("minute").innerHTML="00";
                                me=0;
                                hr += 1;
                                document.getElementById("hour").innerHTML=hr;
                            }else{
                                document.getElementById("minute").innerHTML=me;
                            }
                        }
                            sd=1;
                        }
                    }
                } 
                document.getElementById("cover").style.display="none";
            }
            timer += 1;
            nbtd = 1;
            
            document.getElementById("tdtd1").style.backgroundColor = "grey";
            for (i=1; i<=sizemain*sizemain; i++) {
                countclickno[i] = 0;
                countclicktd[i] = 0;
            }
            countclicktd[1] = 1;
        }
        /*Onclick*/
        function set(elmn,clr,clr1){
            var timercount=0;
            var countclick=0;
            if (clr == "td"){
                countclicktd[clr1] = 1;
                nbtd = clr1;/*Biến chứa vị trí ảnh xuất hiện ở phần kết quả*/
                if (countresult[clr1] == 0) {
                   if (nbtd2 == 0) {
                        nbtd1 = clr1;
                        for (i =1; i <= sizemain*sizemain; i++){
                            if (clr1 != i){
                                document.getElementById("tdtd" + i).style.backgroundColor = "greenyellow";   
                                countclicktd[i] = 0;
                            } 
                        }
                        elmn.style.backgroundColor = "grey";
                        document.getElementById("td" + clr1).style.visibility = "hidden";
                        for (i = 1; i <= sizemain*sizemain; i++){
                            if (countresult[i] != 0){
                                document.getElementById("tdtd" + i).style.opacity = "1";
                            }
                        }
                    } else {
                        countclicktd[nbtd2] = 1;
                        for (i = 1; i <= sizemain*sizemain; i++){
                            if (nbtd2 != i){
                                document.getElementById("tdtd" + i).style.backgroundColor = "greenyellow";   
                                countclicktd[i] = 0;
                            } 
                            if (tdnumber[i] == countresult[nbtd2]){
                                x = document.getElementById("td" + clr1);
                                x.src=adds;
                                x.style.width=setw+"px";
                                x.style.height=seth+"px";
                                x.style.top = (topimg[clr1] - topclip[imgnumber[i]]) + "px";
                                x.style.left= (leftimg[clr1] - leftclip[imgnumber[i]]) + "px";
                                t = cliptop[imgnumber[i]];
                                r = clipright[imgnumber[i]];
                                b = clipbottom[imgnumber[i]];
                                l = clipleft[imgnumber[i]];
                                x.style.clip= "rect("+ t + "px,"+ r + "px,"+ b + "px,"+ l + "px)";
                                y = document.getElementById("td" + clr1);
                                y.style.visibility = "visible";
                                y = document.getElementById("tdtd" + clr1);
                                y.style.opacity = "1";
                                countresult[clr1] = countresult[nbtd2]; 
                                countresult[nbtd2] = 0;
                            }    
                        }                       
                        document.getElementById("tdtd" + nbtd2).style.backgroundColor = "grey";
                        document.getElementById("tdtd" + nbtd2).style.opacity = "1";
                        document.getElementById("td" + nbtd2).style.visibility = "hidden";
                        document.getElementById("td" + nbtd2).style.top = "";
                        document.getElementById("td" + nbtd2).style.left = "";
                        nbtd = nbtd2;
                        nbtd1 = 0;
                        nbtd2 = 0;
                   }
                }else{
                    if (nbtd2 == 0) {
                        if (nbtd1 == 0) {
                            elmn.style.opacity = "0.4";
                            for (i = 1; i <= sizemain*sizemain; i++){
                                if (i != clr1){
                                    document.getElementById("tdtd" + i).style.opacity = "1";
                                    document.getElementById("tdtd" + i).style.backgroundColor = "greenyellow"; 
                                    countclicktd[i] = 0;
                                }
                            }
                            nbtd2 = clr1;
                        } else {
                            countclicktd[clr1] = 1;
                            for (i = 1; i <= sizemain*sizemain; i++){
                                if (clr1 != i){
                                    document.getElementById("tdtd" + i).style.backgroundColor = "greenyellow";   
                                    countclicktd[i] = 0;
                                } 
                                if (tdnumber[i] == countresult[clr1]){
                                    x = document.getElementById("td" + nbtd1);
                                    x.src=adds;
                                    x.style.width=setw+"px";
                                    x.style.height=seth+"px";
                                    x.style.top = (topimg[nbtd1] - topclip[imgnumber[i]]) + "px";
                                    x.style.left= (leftimg[nbtd1] - leftclip[imgnumber[i]]) + "px";
                                    t = cliptop[imgnumber[i]];
                                    r = clipright[imgnumber[i]];
                                    b = clipbottom[imgnumber[i]];
                                    l = clipleft[imgnumber[i]];
                                    x.style.clip= "rect("+ t + "px,"+ r + "px,"+ b + "px,"+ l + "px)";
                                    y = document.getElementById("td" + nbtd1);
                                    y.style.visibility = "visible";
                                    y = document.getElementById("tdtd" + nbtd1);
                                    y.style.opacity = "1";
                                    countresult[nbtd1] = countresult[clr1]; 
                                    countresult[clr1] = 0;
                                }    
                            }
                            nbtd = clr1;
                            nbtd1 = 0;
                            elmn.style.backgroundColor = "grey";
                            document.getElementById("td" + clr1).style.visibility = "hidden";
                            document.getElementById("td" + clr1).style.top = "";
                            document.getElementById("td" + clr1).style.left = "";
                        }
                    } else {
                        for (i = 1; i <= sizemain*sizemain; i++){
                            if (tdnumber[i] == countresult[clr1]){
                                x = document.getElementById("td" + nbtd2);
                                x.src=adds;
                                x.style.width=setw+"px";
                                x.style.height=seth+"px";
                                x.style.top = (topimg[nbtd2] - topclip[imgnumber[i]]) + "px";
                                x.style.left= (leftimg[nbtd2] - leftclip[imgnumber[i]]) + "px";
                                t = cliptop[imgnumber[i]];
                                r = clipright[imgnumber[i]];
                                b = clipbottom[imgnumber[i]];
                                l = clipleft[imgnumber[i]];
                                x.style.clip= "rect("+ t + "px,"+ r + "px,"+ b + "px,"+ l + "px)";     
                            } 
                            if (tdnumber[i] == countresult[nbtd2]){
                                x = document.getElementById("td" + clr1);
                                x.src=adds;
                                x.style.width=setw+"px";
                                x.style.height=seth+"px";
                                x.style.top = (topimg[clr1] - topclip[imgnumber[i]]) + "px";
                                x.style.left= (leftimg[clr1] - leftclip[imgnumber[i]]) + "px";
                                t = cliptop[imgnumber[i]];
                                r = clipright[imgnumber[i]];
                                b = clipbottom[imgnumber[i]];
                                l = clipleft[imgnumber[i]];
                                x.style.clip= "rect("+ t + "px,"+ r + "px,"+ b + "px,"+ l + "px)";     
                            }    
                        }
                        y = document.getElementById("tdtd" + nbtd2);
                        y.style.opacity = "1";
                        y = countresult[nbtd2]; 
                        countresult[nbtd2] = countresult[clr1];
                        countresult[clr1] = y;  
                        nbtd1 = 0;
                        nbtd2 = 0; 
                        x=0;
                        for (i=1; i<=sizemain*sizemain; i++) {
                            if (countresult[i] != 0) {
                                x += 1;
                                countclicktd[i] = 0;
                            }
                        } 
                        //Dừng thời gian khi hoàn thành 
                        for (i=1;i<=sizemain*sizemain;i++) {
                            if(parseFloat(document.getElementById("td"+i).style.left) == 0) {
                                if (parseFloat(document.getElementById("td"+i).style.top) == 0) {
                                    timercount += 1;
                                }
                            }
                        }
                        if (timercount == (sizemain*sizemain)) {
                            document.getElementById("xchoice").innerHTML="CONGRATULATION!";
                            document.getElementById("cover").style.display="block";
                            sd=70;
                            visible();
                        }
                        if (x < sizemain*sizemain){
                            //Tìm ô gần nhất để nhảy sang
                            k = 0;
                            findmin=[0];
                            nbmin=[0];
                            for (j = 1; j <= sizemain*sizemain; j++){
                                if (countresult[j] == 0){
                                    k++;
                                    findmin[k] = j;
                                }
                            }
                            k=0;
                            for (j = 1; j <= findmin.length; j++){
                                k++;
                                nbmin[k] = Math.abs(nbtd - findmin[j])
                            }
                            n = nbmin[1];
                            k = 1;
                            for (j = 2; j <= nbmin.length; j++){
                                if (nbmin[j] <= n){
                                    n = nbmin[j];
                                    k = j;
                                }
                            }
                            nbtd = findmin[k];
                            countclicktd[nbtd] = 1;
                            document.getElementById("tdtd" + nbtd).style.backgroundColor = "grey"; 
                        }
                    }
                }
            } else {
                for (i=1; i<=sizemain*sizemain;i++) {
                    if (countclicktd[i] != 0) {
                        countclick += 1;
                    }
                }
                if (countclick == 1) {
                    if (countrandom[clr1] != 0){
                        nbtd1 = 0;
                        nbtd2 = 0;
                        for (i = 1; i <= sizemain*sizemain; i++){
                            if (tdnumber[i] == clr1){
                                x = document.getElementById("td" + nbtd);
                                x.src=adds;
                                x.style.width=setw+"px";
                                x.style.height=seth+"px";
                                x.style.top = (topimg[nbtd] - topclip[imgnumber[i]]) + "px";
                                x.style.left= (leftimg[nbtd] - leftclip[imgnumber[i]]) + "px";
                                t = cliptop[imgnumber[i]];
                                r = clipright[imgnumber[i]];
                                b = clipbottom[imgnumber[i]];
                                l = clipleft[imgnumber[i]];
                                x.style.clip= "rect("+ t + "px,"+ r + "px,"+ b + "px,"+ l + "px)";
                                y = document.getElementById("td" + nbtd);
                                y.style.visibility = "visible";
                                y = document.getElementById("tdtd" + nbtd);
                                y.style.opacity = "1";
                                elmn.style.opacity = "0";
                                countrandom[clr1] = 0;
                                if (countresult[nbtd] != 0){
                                    document.getElementById("tdno" + countresult[nbtd]).style.opacity = "1";
                                    countrandom[countresult[nbtd]] = countresult[nbtd];
                                }
                                countresult[nbtd] = clr1; 
                            }    
                        }
                        //Dừng thời gian khi hoàn thành 
                        for (i=1;i<=sizemain*sizemain;i++) {
                            if(parseFloat(document.getElementById("td"+i).style.left) == 0) {
                                if (parseFloat(document.getElementById("td"+i).style.top) == 0) {
                                    timercount += 1;
                                }
                            }
                        }
                        if (timercount == (sizemain*sizemain)) {
                            document.getElementById("xchoice").innerHTML="CONGRATULATION!";
                            document.getElementById("cover").style.display="block";
                            sd=70;
                            visible();
                        }
                        //Tìm ô gần nhất để nhảy sang
                        k = 0;
                        findmin=[0];
                        nbmin=[0];
                        for (j = 1; j <= sizemain*sizemain; j++){
                            if (countresult[j] == 0){
                                k++;
                                findmin[k] = j;
                            }
                        }
                        k=0;
                        for (j = 1; j <= findmin.length; j++){
                            k++;
                            nbmin[k] = Math.abs(nbtd - findmin[j])
                        }
                        n = nbmin[1];
                        k = 1;
                        for (j = 2; j <= nbmin.length; j++){
                            if (nbmin[j] <= n){
                                n = nbmin[j];
                                k = j;
                            }
                        }
                        nbtd = findmin[k];
                        countclicktd[nbtd] = 1;
                        for (i=1; i<=sizemain*sizemain; i++) {
                            if (i != nbtd) {
                                countclicktd[i] = 0;
                            }
                        }
                        document.getElementById("tdtd" + nbtd).style.backgroundColor = "grey";
                    }
                }
            }
        }
        /*Double click
        
        function hidn(elmn,clr,clr1){
            var timercount=0;
            if (clr == "td"){
                if (countresult[clr1] != 0){
                    document.getElementById("tdno" + countresult[clr1]).style.opacity = "1";
                    document.getElementById("td" + clr1).style.visibility = "hidden";
                    document.getElementById("td" + clr1).style.top = "";
                    document.getElementById("td" + clr1).style.left = "";
                    nbtd = clr1;
                    nbhd[clr1] = 1;
                    elmn.style.backgroundColor = "grey";
                    countrandom[countresult[clr1]] = countresult[clr1];
                    countresult[clr1] = 0;
                    elmn.style.opacity = "1";
                }else{
                    elmn.style.backgroundColor = "grey";
                    }
            }else{
                if (countrandom[clr1] != 0){
                    for (i = 1; i <= sizemain*sizemain; i++){
                        if (tdnumber[i] == clr1){
                            x = document.getElementById("td" + nbtd);
                            x.src=adds;
                            x.style.width=setw+"px";
                            x.style.height=seth+"px";
                            x.style.top = (topimg[nbtd] - topclip[imgnumber[i]]) + "px";
                            x.style.left= (leftimg[nbtd] - leftclip[imgnumber[i]]) + "px";
                            t = cliptop[imgnumber[i]];
                            r = clipright[imgnumber[i]];
                            b = clipbottom[imgnumber[i]];
                            l = clipleft[imgnumber[i]];
                            x.style.clip= "rect("+ t + "px,"+ r + "px,"+ b + "px,"+ l + "px)";
                            y = document.getElementById("td" + nbtd);
                            y.style.visibility = "visible";
                            y = document.getElementById("tdtd" + nbtd);
                            y.style.opacity = "1";
                            elmn.style.opacity = "0";
                            countrandom[clr1] = 0;
                            if (countresult[nbtd] != 0){
                                document.getElementById("tdno" + countresult[nbtd]).style.opacity = "1";
                                countrandom[countresult[nbtd]] = countresult[nbtd];
                            }
                            countresult[nbtd] = clr1; 
                        }    
                    }
                    //Dừng thời gian khi hoàn thành 
                    for (i=1;i<=sizemain*sizemain;i++) {
                        if(parseFloat(document.getElementById("td"+i).style.left) == 0) {
                            if (parseFloat(document.getElementById("td"+i).style.top) == 0) {
                                timercount += 1;
                            }
                        }
                    }
                    if (timercount == (sizemain*sizemain)) {
                        document.getElementById("xchoice").innerHTML="CONGRATULATION!";
                        document.getElementById("cover").style.display="block";
                        sd=70;
                        visible();
                    }
                    //Tìm ô gần nhất để nhảy sang
                    k = 0;
                    findmin=[0];
                    nbmin=[0];
                    for (j = 1; j <= sizemain*sizemain; j++){
                        if (countresult[j] == 0){
                            k++;
                            findmin[k] = j;
                        }
                    }
                    k=0;
                    for (j = 1; j <= findmin.length; j++){
                        k++;
                        nbmin[k] = Math.abs(nbtd - findmin[j])
                    }
                    n = nbmin[1];
                    k = 1;
                    for (j = 2; j <= nbmin.length; j++){
                        if (nbmin[j] <= n){
                            n = nbmin[j];
                            k = j;
                        }
                    }
                    nbtd = findmin[k];
                    document.getElementById("tdtd" + nbtd).style.backgroundColor = "grey";
                }
            }
        }  */
   
    </script>
</body>
</html>